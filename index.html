<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>SimuSimu - v1.7 Final e Estável</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
</head>
<body class="theme-dark">

<!-- TELA 1: MENU PRINCIPAL -->
<div id="main-menu-container" class="panel">
    <h1 class="game-title">SimuSimu</h1>
    <p class="game-subtitle">Um Simulador de Simulações</p>
    <button id="btn-nova-simulacao">Nova Simulação</button>
    <button class="btn-disabled" title="Em breve!">Carregar Simulação</button>
    <div class="main-menu-secondary-buttons">
        <button id="btn-toggle-theme" class="btn-secondary">Alternar Tema</button>
        <button id="btn-fullscreen" class="btn-secondary" title="Tela Cheia">
             <span>Tela Cheia</span>
        </button>
    </div>
</div>

<!-- TELA 2: CONFIGURAÇÃO DA SIMULAÇÃO -->
<div id="setup-container" class="panel hidden">
    <h1>Configurar Nova Simulação</h1>
    <div class="setup-section">
        <h3>Cenário e Recursos</h3>
        <div class="input-group"><label for="scenario">Cenário:</label><select id="scenario"><option value="floresta">Floresta</option><option value="aquario">Aquário</option><option value="deserto">Deserto</option></select></div>
        <div class="input-group"><label for="numComida">Comida Inicial:</label><input type="number" id="numComida" value="20" min="1" max="100"></div>
        <div class="input-group"><label for="numAgua">Água Inicial:</label><input type="number" id="numAgua" value="5" min="1" max="20"></div>
    </div>
    <div class="setup-section">
        <h3>Animais Iniciais</h3>
        <div id="animal-selection"></div>
    </div>
    <button id="iniciarSimulacao">Iniciar Simulação</button>
    <button id="btn-voltar-menu" class="btn-secondary">Voltar ao Menu</button>
</div>

<!-- TELA 3: JOGO -->
<div id="game-container" class="hidden">
    <div id="world-viewport">
        <div id="world">
            <div id="world-overlay"></div>
            <div id="particle-container"></div>
        </div>
    </div>
    
    <div id="info-panel" class="panel">
        <div id="main-info-panel">
            <div class="tabs">
                <button class="tab-button active" data-tab="status">Status</button>
                <button class="tab-button" data-tab="graficos">Gráficos</button>
                <button class="tab-button" data-tab="log">Log</button>
            </div>
            <div id="tab-status" class="tab-content active">
                <h2>Status da Simulação</h2>
                <div class="stats-grid">
                    <div class="stat-item"><span>População</span><span id="populacaoTotal">0</span></div>
                    <div class="stat-item"><span>Tempo</span><span id="tempo">0s</span></div>
                </div>
                <div id="animal-counts"></div>
                <h3 class="panel-subtitle">Controle de Tempo</h3>
                 <div id="time-controls" class="btn-group">
                    <button class="btn-time" data-speed="0" title="Pausar"><i class="fa-solid fa-pause"></i></button>
                    <button class="btn-time" data-speed="0.5" title="Câmera Lenta"><i class="fa-solid fa-backward-step"></i></button>
                    <button class="btn-time active" data-speed="1" title="Velocidade Normal"><i class="fa-solid fa-play"></i></button>
                    <button class="btn-time" data-speed="2" title="2x Velocidade"><i class="fa-solid fa-forward"></i></button>
                    <button class="btn-time" data-speed="5" title="5x Velocidade"><i class="fa-solid fa-forward-fast"></i></button>
                </div>
                <h3 class="panel-subtitle">Ações Manuais</h3>
                <div class="btn-group interaction-group">
                    <button class="btn-interaction" id="btn-add-comida">Comida</button>
                    <button class="btn-interaction" id="btn-add-rato">Rato</button>
                    <button class="btn-interaction" id="btn-add-coelho">Coelho</button>
                    <button class="btn-interaction" id="btn-colocar-pedra">Pedra</button>
                    <button class="btn-interaction" id="btn-modo-territorio">Territórios</button>
                </div>
            </div>
            <div id="tab-graficos" class="tab-content">
                <h2>Gráfico Populacional</h2>
                <div class="chart-container">
                    <canvas id="populationChart"></canvas>
                </div>
            </div>
            <div id="tab-log" class="tab-content">
                <h2>Log de Eventos</h2>
                <div id="log-container"></div>
            </div>
            <button id="resetarSimulacao" class="btn-danger">Encerrar Simulação</button>
        </div>
        <div id="inspection-panel" class="hidden">
            <div class="inspection-header">
                <h2 id="inspect-nome">Nome do Animal</h2>
                <button id="btn-fechar-inspecao" title="Voltar"><i class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="inspection-body">
                <p><strong>Espécie:</strong> <span id="inspect-especie"></span></p>
                <p><strong>Idade:</strong> <span id="inspect-idade"></span></p>
                <p><strong>Tribo:</strong> <span id="inspect-tribo">Nenhuma</span></p>
                <p><strong>Função:</strong> <span id="inspect-funcao">Nenhuma</span></p>
                <!-- NOVO CAMPO DE ESTADO -->
                <p><strong>Ação Atual:</strong> <span id="inspect-estado"></span></p>
                
                <h3 class="panel-subtitle">Status</h3>
                <div class="inspect-stat"><label>Saúde (Fome)</label><div class="stat-bar-container"><div id="inspect-fome" class="stat-bar"></div></div></div>
                <div class="inspect-stat"><label>Hidratação (Sede)</label><div class="stat-bar-container"><div id="inspect-sede" class="stat-bar"></div></div></div>
                 <div class="inspect-stat"><label>Calor (Frio)</label><div class="stat-bar-container"><div id="inspect-frio" class="stat-bar"></div></div></div>
            </div>
        </div>
    </div>
</div>
<script>
document.addEventListener('DOMContentLoaded', () => {
    const infoPanel = document.getElementById('info-panel');
    if (!infoPanel) return;
    infoPanel.querySelector('#main-info-panel').addEventListener('click', function(e) {
        if (e.target.closest('.tab-button')) {
            const tabButton = e.target.closest('.tab-button');
            const tabId = tabButton.dataset.tab;
            infoPanel.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            infoPanel.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            tabButton.classList.add('active');
            document.getElementById(`tab-${tabId}`).classList.add('active');
        }
    });
    const themeToggleButton = document.getElementById('btn-toggle-theme');
    themeToggleButton.addEventListener('click', () => {
        document.body.classList.toggle('theme-light');
        document.body.classList.toggle('theme-dark');
    });
});
</script>
<script src="script.js"></script>
</body>
</html>
